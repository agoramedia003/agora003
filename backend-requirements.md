# متطلبات الخلفية (Backend) لتطبيق وجباتي

## نظرة عامة

يحتاج تطبيق وجباتي إلى خلفية (backend) قوية لدعم وظائفه المختلفة مثل إدارة المستخدمين، الطلبات، برنامج الولاء، بطاقات الهدايا، ونظام المحفظة. هذا المستند يحدد العناصر التي تحتاج إلى تكامل مع قاعدة البيانات والخدمات الخلفية.

## 1. نظام المصادقة وإدارة المستخدمين

### الوظائف التي تحتاج إلى backend:
- تسجيل الدخول باستخدام رقم الهاتف ورمز PIN (`src/components/login/index.tsx`)
- تسجيل مستخدمين جدد
- تحديث معلومات الملف الشخصي (`src/components/profile/index.tsx`)
- تغيير كلمة المرور
- تخزين عناوين المستخدمين

### واجهات برمجة التطبيقات (APIs) المطلوبة:
- `POST /api/auth/login` - تسجيل الدخول
- `POST /api/auth/register` - تسجيل مستخدم جديد
- `GET /api/users/profile` - الحصول على معلومات الملف الشخصي
- `PUT /api/users/profile` - تحديث معلومات الملف الشخصي
- `PUT /api/users/password` - تغيير كلمة المرور
- `GET /api/users/addresses` - الحصول على عناوين المستخدم
- `POST /api/users/addresses` - إضافة عنوان جديد
- `PUT /api/users/addresses/:id` - تحديث عنوان

## 2. إدارة المنتجات والمتجر

### الوظائف التي تحتاج إلى backend:
- عرض قائمة المنتجات (`src/components/store/index.tsx`)
- تصفية المنتجات حسب الفئة
- عرض تفاصيل المنتج
- إدارة الإضافات والخيارات
- عرض وصف قصير للمنتجات
- عرض مكونات المنتجات

### واجهات برمجة التطبيقات (APIs) المطلوبة:
- `GET /api/products` - الحصول على قائمة المنتجات
- `GET /api/products/categories` - الحصول على فئات المنتجات مع صور الفئات
- `GET /api/products/:id` - الحصول على تفاصيل منتج محدد
- `GET /api/products/extras` - الحصول على قائمة الإضافات المتاحة
- `GET /api/products/:id/components` - الحصول على مكونات منتج محدد

## 3. إدارة سلة التسوق والطلبات

### الوظائف التي تحتاج إلى backend:
- إضافة منتجات إلى سلة التسوق (`src/components/store/index.tsx`)
- تعديل كميات المنتجات في السلة (`src/components/cart/index.tsx`)
- إنشاء طلب جديد
- تتبع حالة الطلب (`src/components/orders/index.tsx`)
- عرض سجل الطلبات السابقة
- إدارة عناصر الطلبات

### واجهات برمجة التطبيقات (APIs) المطلوبة:
- `GET /api/cart` - الحصول على محتويات سلة التسوق
- `POST /api/cart` - إضافة منتج إلى السلة
- `PUT /api/cart/:itemId` - تحديث كمية منتج في السلة
- `DELETE /api/cart/:itemId` - إزالة منتج من السلة
- `POST /api/orders` - إنشاء طلب جديد
- `GET /api/orders` - الحصول على قائمة الطلبات
- `GET /api/orders/:id` - الحصول على تفاصيل طلب محدد
- `GET /api/orders/:id/items` - الحصول على عناصر طلب محدد
- `GET /api/orders/:id/track` - تتبع حالة طلب محدد

## 4. نظام المحفظة والكوينز

### الوظائف التي تحتاج إلى backend:
- عرض رصيد الكوينز (`src/components/home/CoinsBalanceCard.tsx`, `src/components/wallet/index.tsx`)
- تحويل الكوينز إلى مستخدمين آخرين
- عرض سجل معاملات الكوينز
- استخدام الكوينز للدفع
- إدارة تحويلات الكوينز

### واجهات برمجة التطبيقات (APIs) المطلوبة:
- `GET /api/wallet/balance` - الحصول على رصيد الكوينز
- `POST /api/wallet/transfer` - تحويل كوينز إلى مستخدم آخر
- `GET /api/wallet/transactions` - الحصول على سجل المعاملات
- `POST /api/wallet/redeem` - استخدام الكوينز للدفع
- `GET /api/wallet/transfers` - الحصول على سجل التحويلات
- `GET /api/wallet/transfers/:id` - الحصول على تفاصيل تحويل محدد

## 5. برنامج الولاء وبطاقات الهدايا

### الوظائف التي تحتاج إلى backend:
- عرض بطاقات المكافآت (`src/components/loyalty/index.tsx`, `src/components/home/RewardsCarousel.tsx`)
- عرض بطاقات الهدايا (`src/components/cards/index.tsx`, `src/components/home/GiftCardsCarousel.tsx`)
- تفعيل بطاقات جديدة
- إضافة طوابع إلى بطاقات المكافآت
- استبدال المكافآت
- إدارة ألوان البطاقات (خلفية ونص)

### واجهات برمجة التطبيقات (APIs) المطلوبة:
- `GET /api/loyalty/cards` - الحصول على بطاقات المكافآت
- `GET /api/loyalty/gift-cards` - الحصول على بطاقات الهدايا
- `POST /api/loyalty/activate` - تفعيل بطاقة جديدة
- `POST /api/loyalty/stamps` - إضافة طابع إلى بطاقة مكافآت
- `POST /api/loyalty/redeem` - استبدال مكافأة
- `PUT /api/loyalty/cards/:id/colors` - تحديث ألوان البطاقة

## 6. العروض والتخفيضات

### الوظائف التي تحتاج إلى backend:
- عرض العروض الحالية (`src/components/promotions/index.tsx`, `src/components/home/FlashDealsSection.tsx`)
- تطبيق التخفيضات على الطلبات

### واجهات برمجة التطبيقات (APIs) المطلوبة:
- `GET /api/promotions` - الحصول على قائمة العروض
- `GET /api/promotions/:id` - الحصول على تفاصيل عرض محدد
- `POST /api/promotions/apply` - تطبيق عرض على طلب

## 7. الإشعارات

### الوظائف التي تحتاج إلى backend:
- إرسال إشعارات عن حالة الطلب
- إشعارات عن العروض الجديدة
- إشعارات عن تحديثات برنامج الولاء

### واجهات برمجة التطبيقات (APIs) المطلوبة:
- `GET /api/notifications` - الحصول على قائمة الإشعارات
- `PUT /api/notifications/:id` - تحديث حالة الإشعار (مقروء/غير مقروء)
- `POST /api/notifications/token` - تسجيل توكن الجهاز للإشعارات

## ملاحظات تنفيذية

1. **المصادقة**: يجب استخدام JWT (JSON Web Tokens) للمصادقة وإدارة الجلسات.

2. **الأمان**: يجب تشفير كلمات المرور وبيانات المستخدم الحساسة.

3. **التوسع**: تصميم النظام بحيث يمكن توسيعه لدعم المزيد من المستخدمين والمعاملات.

4. **الوقت الحقيقي**: استخدام تقنيات مثل WebSockets لتحديثات حالة الطلب في الوقت الحقيقي.

5. **التخزين المؤقت**: تنفيذ استراتيجيات التخزين المؤقت لتحسين الأداء وتقليل الحمل على الخادم.

6. **التكامل مع خدمات الطرف الثالث**: قد تحتاج إلى التكامل مع:
   - خدمات الدفع
   - خدمات إرسال الرسائل النصية للتحقق
   - خدمات الخرائط والموقع الجغرافي
   - خدمات الإشعارات
