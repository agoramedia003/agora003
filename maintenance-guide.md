# دليل صيانة تطبيق وجباتي

## نظرة عامة

هذا الدليل يوفر معلومات شاملة عن بنية تطبيق وجباتي، ومكوناته، وكيفية صيانته. يهدف هذا الدليل إلى مساعدة المطورين في فهم التطبيق وإجراء التعديلات والإصلاحات بكفاءة.

## هيكل المشروع

### المجلدات الرئيسية

```
src/
├── components/       # مكونات واجهة المستخدم
├── services/         # خدمات API والتكامل مع الخلفية
├── types/            # أنواع TypeScript
├── lib/              # وظائف مساعدة وأدوات
└── main.tsx          # نقطة الدخول للتطبيق
```

### مكونات واجهة المستخدم

تنظم مكونات واجهة المستخدم حسب الوظيفة:

```
components/
├── about/            # صفحة من نحن
├── cards/            # صفحة بطاقات الهدايا
├── cart/             # صفحة سلة التسوق
├── home/             # الصفحة الرئيسية ومكوناتها
├── layout/           # مكونات التخطيط (Header, MobileNavBar)
├── login/            # صفحة تسجيل الدخول
├── loyalty/          # صفحة برنامج الولاء
├── orders/           # صفحة تتبع الطلبات
├── profile/          # صفحة الملف الشخصي
├── promotions/       # صفحة العروض
├── store/            # صفحة المتجر
├── ui/               # مكونات واجهة المستخدم العامة (ShadCN)
└── wallet/           # صفحة محفظة الكوينز
```

## المكونات الرئيسية وعلاقاتها

### 1. التنقل والتخطيط

- **Layout.tsx**: المكون الرئيسي الذي يحتوي على Header و MobileNavBar ويتحقق من حالة تسجيل الدخول.
- **Header.tsx**: شريط التنقل العلوي للتطبيق، يعرض روابط التنقل ورصيد الكوينز وعدد العناصر في سلة التسوق.
- **MobileNavBar.tsx**: شريط التنقل السفلي للأجهزة المحمولة، يعرض أيقونات للصفحات الرئيسية.

### 2. الصفحة الرئيسية

- **home.tsx**: الصفحة الرئيسية التي تجمع المكونات التالية:
  - **CoinsBalanceCard.tsx**: بطاقة تعرض رصيد الكوينز.
  - **GiftCardsCarousel.tsx**: عرض متحرك لبطاقات الهدايا.
  - **RewardsCarousel.tsx**: عرض متحرك للمكافآت.
  - **FlashDealsSection.tsx**: قسم يعرض العروض المحدودة.

### 3. المتجر وسلة التسوق

- **store/index.tsx**: صفحة المتجر التي تعرض المنتجات وتسمح بتصفيتها حسب الفئة.
- **cart/index.tsx**: صفحة سلة التسوق التي تعرض المنتجات المضافة وتسمح بتعديل الكميات وإتمام الطلب.

### 4. برنامج الولاء

- **loyalty/index.tsx**: صفحة برنامج الولاء التي تعرض بطاقات المكافآت وبطاقات الهدايا.
- **cards/index.tsx**: صفحة اكتشاف وتفعيل البطاقات.

### 5. المحفظة والطلبات

- **wallet/index.tsx**: صفحة محفظة الكوينز التي تعرض الرصيد وسجل المعاملات.
- **orders/index.tsx**: صفحة تتبع الطلبات التي تعرض الطلبات الحالية والسابقة وحالتها.

## إدارة الحالة

يستخدم التطبيق مزيجًا من:

1. **حالة المكون المحلية**: باستخدام `useState` و `useEffect` للحالات البسيطة داخل المكونات.
2. **التخزين المحلي (localStorage)**: لتخزين معلومات المصادقة والبيانات المستمرة.
3. **خدمات API**: للتفاعل مع الخلفية واسترجاع البيانات.

## التوجيه (Routing)

iيستخدم التطبيق React Router للتنقل بين الصفحات. المسارات الرئيسية هي:

- `/`: الصفحة الرئيسية
- `/login`: صفحة تسجيل الدخول
- `/store`: صفحة المتجر
- `/cart`: سلة التسوق
- `/loyalty`: برنامج الولاء
- `/wallet`: محفظة الكوينز
- `/orders`: تتبع الطلبات
- `/profile`: الملف الشخصي
- `/about`: صفحة من نحن
- `/cards`: صفحة بطاقات الهدايا
- `/promotions`: صفحة العروض

## التكامل مع الخلفية

يتفاعل التطبيق مع الخلفية من خلال خدمات API المنظمة في مجلد `services/api`. كل خدمة تتعامل مع مجموعة محددة من نقاط النهاية:

- **apiClient.ts**: عميل HTTP أساسي يتعامل مع الطلبات والاستجابات.
- **authService.ts**: خدمة المصادقة وإدارة المستخدمين.
- **productService.ts**: خدمة المنتجات والفئات.
- **cartService.ts**: خدمة سلة التسوق.
- **orderService.ts**: خدمة الطلبات وتتبعها.
- **walletService.ts**: خدمة محفظة الكوينز والمعاملات.
- **loyaltyService.ts**: خدمة برنامج الولاء وبطاقات الهدايا.
- **promotionService.ts**: خدمة العروض والتخفيضات.
- **notificationService.ts**: خدمة الإشعارات.

## إجراءات الصيانة الشائعة

### 1. تغيير النصوص والترجمات

النصوص مضمنة مباشرة في المكونات. لتغيير نص:

1. حدد المكون الذي يحتوي على النص.
2. ابحث عن النص المراد تغييره.
3. قم بتحديثه مباشرة في الكود.

### 2. تعديل الأسعار والعملة

الأسعار والعملة مضمنة في المكونات. لتغيير العملة أو تنسيق الأسعار:

1. ابحث عن جميع حالات رمز العملة (مثل "د.م") في المكونات.
2. قم بتحديثها حسب الحاجة.

### 3. إضافة أو تعديل المنتجات

المنتجات تأتي من الخلفية عبر API. لإضافة أو تعديل المنتجات:

1. استخدم واجهة إدارة الخلفية لتحديث المنتجات.
2. تأكد من أن المنتجات تتبع نفس بنية البيانات المتوقعة في التطبيق.

### 4. تعديل التصميم

يستخدم التطبيق Tailwind CSS للتصميم. لتعديل التصميم:

1. حدد المكون المراد تعديله.
2. قم بتحديث فئات Tailwind CSS المطبقة على العناصر.
3. للتغييرات العالمية، قم بتحديث ملف `tailwind.config.js`.

### 5. إضافة صفحة جديدة

لإضافة صفحة جديدة:

1. أنشئ مجلدًا جديدًا في `components/` للصفحة.
2. أنشئ مكون الصفحة الرئيسي في `index.tsx`.
3. أضف المسار الجديد في `App.tsx`.
4. أضف رابطًا للصفحة في `Header.tsx` و/أو `MobileNavBar.tsx`.

## المشاكل الشائعة وحلولها

### 1. مشاكل المصادقة

**المشكلة**: المستخدم يتم تسجيل خروجه بشكل غير متوقع أو لا يمكنه الوصول إلى الصفحات المحمية.

**الحل**:
- تحقق من حالة `isLoggedIn` في التخزين المحلي.
- تحقق من صلاحية رمز JWT في التخزين المحلي.
- تأكد من أن `ProtectedRoute` يعمل بشكل صحيح.

### 2. مشاكل عرض البيانات

**المشكلة**: البيانات لا تظهر أو تظهر بشكل غير صحيح.

**الحل**:
- تحقق من استجابة API في وحدة تحكم المتصفح.
- تأكد من أن بنية البيانات تتطابق مع ما يتوقعه المكون.
- تحقق من حالة التحميل والخطأ في المكون.

### 3. مشاكل التوافق مع الأجهزة المحمولة

**المشكلة**: التصميم لا يظهر بشكل صحيح على الأجهزة المحمولة.

**الحل**:
- تحقق من فئات الاستجابة في Tailwind CSS (مثل `md:`, `lg:`).
- اختبر التطبيق على مختلف أحجام الشاشات باستخدام أدوات المطور في المتصفح.
- تأكد من أن `MobileNavBar` يظهر بشكل صحيح على الأجهزة المحمولة.

### 4. مشاكل الأداء

**المشكلة**: التطبيق بطيء أو يستهلك موارد كثيرة.

**الحل**:
- استخدم تحميل المكونات بشكل كسول (`React.lazy`).
- تحسين الصور وتقليل حجمها.
- تنفيذ التخزين المؤقت للبيانات المستخدمة بشكل متكرر.

## تحديث التطبيق

### 1. تحديث التبعيات

لتحديث التبعيات:

```bash
npm update
```

أو لتحديث تبعية محددة:

```bash
npm update <package-name>
```

### 2. إضافة ميزات جديدة

1. حدد المكونات التي ستتأثر بالميزة الجديدة.
2. قم بتنفيذ التغييرات اللازمة في المكونات والخدمات.
3. اختبر الميزة الجديدة بشكل شامل.
4. قم بتحديث الوثائق حسب الحاجة.

### 3. إصلاح الأخطاء

1. حدد المكون أو الخدمة التي تحتوي على الخطأ.
2. قم بتنفيذ الإصلاح.
3. اختبر الإصلاح للتأكد من أنه لا يؤثر على وظائف أخرى.

## الاختبار

### 1. اختبار يدوي

1. اختبر جميع الوظائف الرئيسية: تسجيل الدخول، تصفح المنتجات، إضافة إلى السلة، إتمام الطلب، إلخ.
2. اختبر على مختلف المتصفحات وأحجام الشاشات.
3. اختبر سيناريوهات الخطأ: اتصال إنترنت ضعيف، استجابات API غير متوقعة، إلخ.

### 2. اختبار تلقائي

يمكن إضافة اختبارات تلقائية باستخدام Jest و React Testing Library:

1. اختبارات الوحدة للمكونات والخدمات.
2. اختبارات التكامل للتفاعلات بين المكونات.
3. اختبارات واجهة المستخدم لتجربة المستخدم الكاملة.

## الموارد

### 1. الوثائق

- **api-documentation.md**: توثيق واجهات برمجة التطبيقات (API).
- **application-components.md**: توثيق مكونات التطبيق والوظائف البرمجية.
- **backend-requirements.md**: متطلبات الخلفية لتطبيق وجباتي.

### 2. المكتبات الرئيسية

- **React**: مكتبة واجهة المستخدم.
- **React Router**: للتوجيه بين الصفحات.
- **Tailwind CSS**: إطار عمل CSS للتصميم.
- **Lucide React**: مكتبة أيقونات.
- **ShadCN UI**: مكونات واجهة المستخدم الأساسية.
- **Axios**: مكتبة HTTP للتفاعل مع API.

## الخاتمة

هذا الدليل يوفر نظرة عامة شاملة عن تطبيق وجباتي وكيفية صيانته. للمزيد من المعلومات التفصيلية، يرجى الرجوع إلى الوثائق المذكورة أعلاه والتعليقات في الكود.
